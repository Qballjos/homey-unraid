{
  "_comment": "Homey app manifest for Unraid integration",
  "id": "com.unraid",
  "version": "0.4.1",
  "compatibility": ">=6.0.0",
  "sdk": 3,
  "author": {
    "name": "Jos Visser",
    "email": "qballjos@gmail.com",
    "url": "https://josvisserict.nl"
  },
  "contributors": {
    "developers": [
      {
        "name": "Jos Visser",
        "email": "qballjos@gmail.com"
      }
    ],
    "translators": []
  },
  "bugs": {
    "url": "https://github.com/Qballjos/homey-unraid/issues"
  },
  "homepage": "https://github.com/Qballjos/homey-unraid",
  "support": "https://github.com/Qballjos/homey-unraid/discussions",
  "source": "https://github.com/Qballjos/homey-unraid",
  "name": {
    "en": "Unraid"
  },
  "icon": "/assets/icon-small.png",
  "images": {
    "small": "/assets/image-small.png",
    "large": "/assets/image-large.png"
  },
  "brandColor": "#E22828",
  "description": {
    "en": "Lightweight monitoring and control for your Unraid server via the official GraphQL API."
  },
  "category": [
    "tools"
  ],
  "capabilities": {
    "measure_cpu": {
      "type": "number",
      "title": { "en": "CPU Load" },
      "units": { "en": "%" },
      "icon": "/assets/cpu.svg",
      "min": 0,
      "max": 100,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_memory": {
      "type": "number",
      "title": { "en": "Memory Used" },
      "units": { "en": "%" },
      "icon": "/assets/memory.svg",
      "min": 0,
      "max": 100,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_cpu_temperature": {
      "type": "number",
      "title": { "en": "CPU Temperature" },
      "units": { "en": "°C" },
      "icon": "/assets/cpu-temp.svg",
      "min": 0,
      "max": 120,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_temperature": {
      "type": "number",
      "title": { "en": "Disk Temperature" },
      "units": { "en": "°C" },
      "min": 0,
      "max": 100,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_disk_usage": {
      "type": "number",
      "title": { "en": "Array Space Used" },
      "units": { "en": "%" },
      "icon": "/assets/disk.svg",
      "min": 0,
      "max": 100,
      "decimals": 1,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_containers": {
      "type": "number",
      "title": { "en": "Containers Running" },
      "units": { "en": "containers" },
      "icon": "/assets/container.svg",
      "min": 0,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "measure_vms": {
      "type": "number",
      "title": { "en": "VMs Running" },
      "units": { "en": "VMs" },
      "icon": "/assets/vm.svg",
      "min": 0,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "meter_uptime": {
      "type": "number",
      "title": { "en": "Uptime" },
      "units": { "en": "hours" },
      "icon": "/assets/uptime.svg",
      "min": 0,
      "decimals": 1,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "array_status": {
      "type": "string",
      "title": { "en": "Array Status" },
      "getable": true,
      "setable": false,
      "uiComponent": null
    },
    "measure_parity_progress": {
      "type": "number",
      "title": { "en": "Parity Progress" },
      "units": { "en": "%" },
      "icon": "/assets/parity.svg",
      "min": 0,
      "max": 100,
      "decimals": 1,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    },
    "meter_array_errors": {
      "type": "number",
      "title": { "en": "Array Errors" },
      "units": { "en": "errors" },
      "icon": "/assets/error.svg",
      "min": 0,
      "decimals": 0,
      "getable": true,
      "setable": false,
      "insights": true,
      "uiComponent": "sensor"
    }
  },
  "platforms": [
    "local"
  ],
  "drivers": [
    {
      "id": "unraid-server",
      "name": {
        "en": "Unraid Server"
      },
      "class": "other",
      "images": {
        "large": "/drivers/unraid-server/assets/icon-large.png",
        "small": "/drivers/unraid-server/assets/icon-small.png"
      },
      "capabilities": [
        "measure_cpu",
        "measure_memory",
        "measure_cpu_temperature",
        "measure_disk_usage",
        "measure_parity_progress",
        "meter_array_errors",
        "measure_containers",
        "measure_vms",
        "meter_uptime",
        "array_status",
        "alarm_generic",
        "measure_temperature"
      ],
      "pair": [
        {
          "id": "list_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_devices"
          }
        },
        {
          "id": "add_devices",
          "template": "add_devices"
        }
      ],
      "settings": [
        {
          "type": "group",
          "label": { "en": "Connection" },
          "children": [
            {
              "id": "baseUrl",
              "type": "text",
              "label": { "en": "Server URL" },
              "hint": { "en": "http://192.168.1.100:8080/graphql" },
              "value": "http://tower:8080/graphql"
            },
            {
              "id": "apiKey",
              "type": "password",
              "label": { "en": "API Key" },
              "hint": { "en": "From Unraid Settings → API" },
              "value": ""
            }
          ]
        },
        {
          "type": "group",
          "label": { "en": "Polling" },
          "children": [
            {
              "id": "pollInterval",
              "type": "number",
              "label": { "en": "Interval (seconds)" },
              "value": 60,
              "attr": { "min": 10, "max": 300, "step": 5 }
            },
            { "id": "pollArray", "type": "checkbox", "label": { "en": "Poll Array & Disks" }, "value": true },
            { "id": "pollDocker", "type": "checkbox", "label": { "en": "Poll Docker" }, "value": true },
            { "id": "pollVms", "type": "checkbox", "label": { "en": "Poll VMs" }, "value": true },
            { "id": "pollShares", "type": "checkbox", "label": { "en": "Poll Shares" }, "value": false }
          ]
        },
        {
          "type": "group",
          "label": { "en": "Thresholds" },
          "children": [
            { "id": "cpuThreshold", "type": "number", "label": { "en": "CPU %" }, "value": 80, "attr": { "min": 10, "max": 100 } },
            { "id": "diskTempThreshold", "type": "number", "label": { "en": "Disk Temp °C" }, "value": 60, "attr": { "min": 20, "max": 90 } },
            { "id": "shareSpaceThreshold", "type": "number", "label": { "en": "Share Space %" }, "value": 90, "attr": { "min": 50, "max": 99 } }
          ]
        },
        {
          "id": "allowControl",
          "type": "checkbox",
          "label": { "en": "Allow control actions (start/stop)" },
          "value": false
        }
      ]
    }
  ],
  "flow": {
    "triggers": [
      {
        "id": "array_started",
        "title": { "en": "Array started" }
      },
      {
        "id": "array_stopped",
        "title": { "en": "Array stopped" }
      },
      {
        "id": "parity_completed",
        "title": { "en": "Parity check completed" }
      },
      {
        "id": "parity_started",
        "title": { "en": "Parity check started" }
      },
      {
        "id": "parity_error",
        "title": { "en": "Parity check error detected" },
        "titleFormatted": { "en": "Parity check found [[errors]] error(s)" },
        "tokens": [
          { "name": "errors", "type": "number", "title": { "en": "Errors" } }
        ]
      },
      {
        "id": "mover_started",
        "title": { "en": "Mover started" }
      },
      {
        "id": "mover_finished",
        "title": { "en": "Mover finished" }
      },
      {
        "id": "disk_temp_warning",
        "title": { "en": "Disk temperature warning" },
        "titleFormatted": { "en": "Disk [[name]] temperature [[temp]]°C" },
        "tokens": [
          { "name": "name", "type": "string", "title": { "en": "Disk" } },
          { "name": "temp", "type": "number", "title": { "en": "Temperature" } }
        ]
      },
      {
        "id": "smart_failure",
        "title": { "en": "SMART failure detected" },
        "titleFormatted": { "en": "Disk [[name]] SMART failure" },
        "tokens": [
          { "name": "name", "type": "string", "title": { "en": "Disk" } }
        ]
      },
      {
        "id": "container_crashed",
        "title": { "en": "Container crashed" },
        "titleFormatted": { "en": "Container [[container_name]] crashed (exit [[exit_code]])" },
        "tokens": [
          { "name": "container_name", "type": "string", "title": { "en": "Container name" } },
          { "name": "exit_code", "type": "number", "title": { "en": "Exit code" } },
          { "name": "status", "type": "string", "title": { "en": "Status text" } },
          { "name": "auto_start", "type": "boolean", "title": { "en": "Auto-start enabled" } }
        ]
      },
      {
        "id": "container_state_changed",
        "title": { "en": "Container state changed" },
        "titleFormatted": { "en": "Container [[container_name]] changed to [[new_state]]" },
        "tokens": [
          { "name": "container_name", "type": "string", "title": { "en": "Container name" } },
          { "name": "old_state", "type": "string", "title": { "en": "Previous state" } },
          { "name": "new_state", "type": "string", "title": { "en": "Current state" } },
          { "name": "status", "type": "string", "title": { "en": "Status text" } },
          { "name": "auto_start", "type": "boolean", "title": { "en": "Auto-start enabled" } }
        ]
      },
      {
        "id": "container_started",
        "title": { "en": "Container started" },
        "titleFormatted": { "en": "Container [[container_name]] started" },
        "tokens": [
          { "name": "container_name", "type": "string", "title": { "en": "Container name" } },
          { "name": "status", "type": "string", "title": { "en": "Status text" } },
          { "name": "auto_start", "type": "boolean", "title": { "en": "Auto-start enabled" } }
        ]
      },
      {
        "id": "container_stopped",
        "title": { "en": "Container stopped" },
        "titleFormatted": { "en": "Container [[container_name]] stopped" },
        "tokens": [
          { "name": "container_name", "type": "string", "title": { "en": "Container name" } },
          { "name": "status", "type": "string", "title": { "en": "Status text" } },
          { "name": "was_auto_start", "type": "boolean", "title": { "en": "Had auto-start" } }
        ]
      },
      {
        "id": "vm_state_changed",
        "title": { "en": "VM state changed" },
        "titleFormatted": { "en": "VM [[vm_name]] changed to [[new_state]]" },
        "tokens": [
          { "name": "vm_name", "type": "string", "title": { "en": "VM name" } },
          { "name": "old_state", "type": "string", "title": { "en": "Previous state" } },
          { "name": "new_state", "type": "string", "title": { "en": "Current state" } },
          { "name": "vm_id", "type": "string", "title": { "en": "VM ID" } }
        ]
      },
      {
        "id": "vm_started",
        "title": { "en": "VM started" },
        "titleFormatted": { "en": "VM [[vm_name]] started" },
        "tokens": [
          { "name": "vm_name", "type": "string", "title": { "en": "VM name" } },
          { "name": "vm_id", "type": "string", "title": { "en": "VM ID" } }
        ]
      },
      {
        "id": "vm_stopped",
        "title": { "en": "VM stopped" },
        "titleFormatted": { "en": "VM [[vm_name]] stopped" },
        "tokens": [
          { "name": "vm_name", "type": "string", "title": { "en": "VM name" } },
          { "name": "vm_id", "type": "string", "title": { "en": "VM ID" } }
        ]
      },
      {
        "id": "cpu_over_threshold",
        "title": { "en": "CPU usage over threshold" },
        "titleFormatted": { "en": "CPU usage is [[percent]]%" },
        "args": [
          { "name": "percent", "type": "number" }
        ]
      },
      {
        "id": "share_space_low",
        "title": { "en": "Share space low" },
        "titleFormatted": { "en": "Share [[share_name]] is [[used_percent]]% full" },
        "tokens": [
          { "name": "share_name", "type": "string", "title": { "en": "Share name" } },
          { "name": "free_gb", "type": "number", "title": { "en": "Free space (GB)" } },
          { "name": "used_gb", "type": "number", "title": { "en": "Used space (GB)" } },
          { "name": "total_gb", "type": "number", "title": { "en": "Total size (GB)" } },
          { "name": "used_percent", "type": "number", "title": { "en": "Used (%)" } },
          { "name": "free_percent", "type": "number", "title": { "en": "Free (%)" } }
        ]
      }
    ],
    "conditions": [
      {
        "id": "array_is_started",
        "title": { "en": "Array is started" }
      },
      {
        "id": "container_is_running",
        "title": { "en": "Container is running" },
        "titleFormatted": { "en": "Container [[name]] is running" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "Container name" }
        }]
      },
      {
        "id": "vm_is_running",
        "title": { "en": "VM is running" },
        "titleFormatted": { "en": "VM [[name]] is running" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "parity_in_progress",
        "title": { "en": "Parity check in progress" }
      },
      {
        "id": "mover_is_running",
        "title": { "en": "Mover is running" }
      },
      {
        "id": "disk_temp_above",
        "title": { "en": "Disk temperature above" },
        "titleFormatted": { "en": "Disk [[name]] temperature above [[threshold]]°C" },
        "args": [
          { "name": "name", "type": "text" },
          { "name": "threshold", "type": "number" }
        ]
      },
      {
        "id": "free_space_above",
        "title": { "en": "Free space above" },
        "titleFormatted": { "en": "[[name]] has more than [[threshold]]% free" },
        "args": [
          { "name": "name", "type": "text", "placeholder": { "en": "share or cache" } },
          { "name": "threshold", "type": "number" }
        ]
      }
    ],
    "actions": [
      {
        "id": "start_array",
        "title": { "en": "Start array" }
      },
      {
        "id": "stop_array",
        "title": { "en": "Stop array" }
      },
      {
        "id": "start_parity_check",
        "title": { "en": "Start parity check" }
      },
      {
        "id": "stop_parity_check",
        "title": { "en": "Stop parity check" }
      },
      {
        "id": "start_mover",
        "title": { "en": "Start mover" }
      },
      {
        "id": "stop_mover",
        "title": { "en": "Stop mover" }
      },
      {
        "id": "start_container",
        "title": { "en": "Start container" },
        "titleFormatted": { "en": "Start container [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "Container name" }
        }]
      },
      {
        "id": "stop_container",
        "title": { "en": "Stop container" },
        "titleFormatted": { "en": "Stop container [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "Container name" }
        }]
      },
      {
        "id": "restart_container",
        "title": { "en": "Restart container" },
        "titleFormatted": { "en": "Restart container [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "Container name" }
        }]
      },
      {
        "id": "update_container",
        "title": { "en": "Update container (pull image)" },
        "titleFormatted": { "en": "Update container [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "Container name" }
        }]
      },
      {
        "id": "start_vm",
        "title": { "en": "Start VM" },
        "titleFormatted": { "en": "Start VM [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "stop_vm",
        "title": { "en": "Stop VM" },
        "titleFormatted": { "en": "Stop VM [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "reboot_vm",
        "title": { "en": "Reboot VM" },
        "titleFormatted": { "en": "Reboot VM [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "pause_vm",
        "title": { "en": "Pause VM" },
        "titleFormatted": { "en": "Pause VM [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "resume_vm",
        "title": { "en": "Resume VM" },
        "titleFormatted": { "en": "Resume VM [[name]]" },
        "args": [{
          "name": "name",
          "type": "autocomplete",
          "placeholder": { "en": "VM name" }
        }]
      },
      {
        "id": "send_unraid_notification",
        "title": { "en": "Send Unraid notification" },
        "titleFormatted": { "en": "Send [[level]] notification: [[message]]" },
        "args": [
          {
            "name": "level",
            "type": "dropdown",
            "title": { "en": "Level" },
            "values": [
              { "id": "normal", "label": { "en": "Normal" } },
              { "id": "warning", "label": { "en": "Warning" } },
              { "id": "alert", "label": { "en": "Alert" } }
            ]
          },
          { "name": "message", "type": "text" }
        ]
      },
      {
        "id": "force_refresh",
        "title": { "en": "Force refresh data" },
        "titleFormatted": { "en": "Force refresh data from Unraid server" },
        "args": [
          {
            "name": "device",
            "type": "device",
            "filter": "driver_id=unraid-server"
          }
        ]
      }
    ]
  },
  "speechExamples": [
    {
      "example": {
        "en": "Hey Homey, what is the Unraid array status?"
      }
    }
  ]
}

